<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Graph Databases for Perovskite Solar Cell Manufacturing</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles/style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js" defer></script>

    <!-- fonts -->
    <style>
    @import url('https://fonts.googleapis.com/css2?family=Bodoni+Moda&family=Karla:wght@300;600&family=Spectral&display=swap');
    </style>
    <link rel="stylesheet" media="screen" href="https://fontlibrary.org//face/symbola" type="text/css"/>

 </head> 
 <body id="index">
    <div id="nav"> 
        <li><a href="#demo"><h3>demo</h3></a></li>
        <li><a href="#abstract">abstract</a></li> 
        <li><a href="#in">intro</a></li>
        <li><a href="#methods">methods</a></li>
        <li><a href="#results">results</a></li>
        <li><a href="#conc">conclusions</a></li>
        <li><a href="#refs">references</a></li>
        <li><label class="switch">
          <div>
            <input type="checkbox"/>
            <span class="slider"></span>
          </div>
        </label></li>
    </div>
    
    <section id="landing" class="layer">
    
      <img class="layer" src="resources/landing.gif" style="z-index:1">
        <div class="page_title">
          <h2 class="page_title">graph databases</h2>
          <h3 class="page_title">for</h3>
          <h2 class="page_title">perovskite solar cell<br>manufacturing</h2>
        </div>
        
        <a class="scroll" href="#abstract">[scroll]<span></span></a>
        
    </section>

    <div class='content'>
      <div class="page_head_spacer"></div>
      
      
        <section id="demo">
          <div class="section_header"><h2>demo</h2></div>
          <p class="writeup">A static view of a subset of the database.</p>

          <div class="demo"> 
        <iframe id="demo" src="https://graphxr.kineviz.com/share/63f7d3193bb85f1508299ec7/Capstone%20DMBS/63f7d4b43bb85f150829a0d3/Capstone%20sample%20view"> </iframe>
      </div>
      </section>
        
      <!-- actual report -->
      <section id="abstract" class = "bodytext">
        <div class="section_header"><div class="card_div"></div><h2>introduction</h2></div>
          <p class="writeup">&emsp; The Solar Energy Innovation Laboratory (SOLEIL), under Professor David Fenning, manufactures and collects increasing amounts of perovskite solar cell data. SOLEIL varies chemicals, processes, and conditions for each cell to find the manufacturing process that produces optimal solar cells.</p>
          <br><br><b class="subheading">existing data pipeline</b>
          <p class="writeup">
              &emsp;- Cell output data is spread across different folders, files, and data types <b>(Figure 1)</b>. Output structure and naming conventions also vary between lab members
              <br>&emsp;- The lab’s machine, PASCAL, uploads data to a Google Drive folder in a partially unregulated manner
              <br>&emsp;- Cost of storage increases with volume of data, making data storage critical <b>(Figure 2)</b>.
              <br>&emsp;- The data associated with one sample's manufacturing process is unstructured and varies batch to batch.
              <br><br>

              <div class="row"><div class="col"><b>Figure 1</b><img class="halfw" src="resources/f1.png">
              </div><div class="col"><b>Figure 2</b><img  class="halfw" src="resources/f1.png"></div></div>
          </p>
          <br><br><b class="subheading">the problem</b>
          <p class="writeup">
              &emsp; Because the data comes in many different and complex formats, it's hard to store, query, and analyze; detecting patterns in their data will allow the lab to find the optimal manufacturing procedure, saving critical time and money.
              <br><br>
              Our project worked to create a database ("DB") that allows the lab to record data in a flexible and predictable manner, and easily query the data for analysis and visualization purposes.
          </p>
      </section>

      <section id="in" class = "bodytext">
        <div class="section_header"><div class="card_div"></div><h2>project background</h2></div>
          <b class="subheading">database requirements</b><br>
          <p class="writeup">&emsp;The SOLEIL lab aims to manufacture and test perovskite solar cells to improve them in different ways - lifespan, efficiency, and manufacturing consistency, to name a few. The lab has an established manufacturing process and robust data collection, but lack a data storage and analysis procedure that allows for consistency, accessibility, and scaleup.
            A successful, useful database solution involves consolidating:
            <br><br>&emsp;- Individual, cell-level chemical compositions, linked to traceable batches of chemicals
            <br>&emsp;- Detailed, cell-level manufacturing data (e.g. steps, completion time)
            <br>&emsp;- Cell-level performance metrics, in a variety of data types (e.g. single integers vs. entire tables)
            <br>&emsp;- Fast queries over a large scale of data for visualization and analysis purposes
            <br>&emsp;- Data insertion, edits, and deletion are operations that are less frequent
            <br>&emsp;- A modular structure that allows for future addition of new procedures, steps, or metrics

            <br><br>All of which ultimately allows the lab to organize their existing data, easily add new cells' data, and efficiently draw insights. 
          </p>
          <br><br><b class="subheading">prior/existing work</b><br>
          <p class="writeup">&emsp;We evaluated a graph database, a traditional tabular database, and a Relational Database (RDB). We hypothesized that a Graph Database might be more suitable due to the lab’s need for fast queries.
          <br><br>&emsp;Out of the existing perovskite cell databases we found that only one, <a href="https://www.perovskitedatabase.com/home">The Perovskite Database</a>, attempted to store manufacturing data; the rest were primarily concerned with chemical compositions, or broader research in general.
          The database, however, being open source, did not address most of the core requirements we identified above.
          </p>
          <br><br><b class="subheading">data description</b><br>
          <p class="writeup">&emsp;Perovskite cell manufacturing data has intrinsic, complex relationships. Cell samples have differing chemical compositions, steps, and metrics. Solvents or precursors used in cells are from different manufacturing batches, and manufacturing steps themselves contain a differing number of sub-steps and chemicals. 
 
          <br>&emsp;Currently, a lab member will run a Jupyter notebook to start manufacturing a batch of cells with PASCAL, which is currently (previous batches were handled differently) configured to output two folders:
          <br><br>&emsp;1&#41; containing a JSON <b>worklist</b> of a chain of steps that each cell sample undergoes, and
          <br>&emsp;2&#41; containing <b>characterization outputs</b> &#40;measurements on metrics that indicate the quality of a cell&#41; and details of the step that captured that metric in another JSON.

          <br><br>Current metrics from the characterization step are:
            <br>&emsp;- PL photostability or PL spectroscopy over time
            <br>&emsp;- Visible light transmission spectroscopy
            <br>&emsp;- PL spectroscopy
            <br>&emsp;- PL image
            <br>&emsp;- Brightfield image
            <br>&emsp;- Darkfield image<br>
            Each sample will have one of each.
            <br><br>

            <b>Characterization output examples:</b>
            <br>&emsp;Images are 1080x1440 each, and CSVs range up to several thousand rows.
            <br><br><div class="row"><div class="col"><img src="resources/f3.png" class="halfw"><br></div><div class="col"><img src="resources/f4.png" class="qw">
            </div></div>
          </p>
  
      </section>

      <section id="methods" class = "bodytext">
        <div class="section_header"><div class="card_div"></div><h2>methods</h2></div>
          <p class="writeup">&emsp;Our final product involves a database and data pipeline.</p>

          <br><b class="subheading">choosing a database</b>
          <br><p class="writeup">&emsp;We built and tested 3 databases:
            <br>&emsp;&emsp;1&#41; A single tabular database (modeled after an existing, private solution we heard from a lab member)
            <br>&emsp;&emsp;2&#41; A tabular, relational database ("RDB")
            <br>&emsp;&emsp;3&#41; A Neo4j graph database
            
            <br><br><br><b>Tabular Databases</b><br>
            1&#41; involved storing entire JSON worklists for each sample into columns in a single table, which can be queried via some versions of SQL. 
            <br>2&#41; involved a fully fledged (PostgreSQL) relational database.
            <br><br>While simple, there are drawbacks:
            <br>&emsp;- Lots of duplicate data and empty cells due to varying numbers of manufacturing steps per sample.
            <br>&emsp;&emsp; e.g. Some cells had an anti-solvent, and some don't - this column has substantial empty entries.
            <br>&emsp;- Fixed tables are not the most flexible - if a new step were to be made, the database schema would have to be updated and all the data reinstantiated 

            <br><br>and for the RDB,
            <br>&emsp;- To have all tables meet the properties of a valid RDB, the data had to be split a lot <b>(Figure 5)</b>.
            <br>&emsp;&emsp; This means poor query runtime, since all tables have to be joined (O(nᵈ) for d tables) every query.
            
           
            <br><br><div class="row"><div class="col"><b>Figure 5</b>Our final proposal RDB schema.            
              <img src="resources/f5.png" class="halfw">There are nine tables; our implementation was able to only use six.
            </div></div>
          
          </p>

          
          
          <br><br><b class="subheading">data pipeline</b>
          <p class="writeup">We built a data import pipeline to take PASCAL’s raw output, clean and consolidate the data, and update the graph DB (Figure 3)
</p>


      </section>

      <section id="results" class = "bodytext">
        <div class="section_header"><div class="card_div"></div><h2>results</h2></div>

        <p class="writeup">&emsp;After graphing the nodes and links from our cleaned/transformed data, we are able to generate a graph for each sample. The figure below shows the contents of one sample:</p>
      </section>

      <section id="conc" class = "bodytext">
        <div class="section_header"><div class="card_div"></div><h2>conclusion</h2></div>
        <p class="writeup">Our group implemented a working lab-to-database pipeline by replicating some existing ideas. In our discussions with Kumar and prior research, we found no similar solutions exist. 
          The usefulness of this solution is largely derived from Neo4j’s Cypher - queries are relatively intuitive and simple to write, though we would need to communicate more with Fenning’s data team to see if there are necessary actions that Cypher does not support. 
        </p>

        <br><br><b class="subheading">example queries</b>
        <br><br><b class="subheading">limitations</b>
        <p class="writeup">&emsp;The Methods section details how we have since solved two of the main limitations we had - the Google Drive rate limit, and the storage of characterization outputs. Our current challenge is working out hosting - Neo4j Docker only runs locally as far as we are aware, and other versions of Neo4j with managed databases are paid. 
          <br>&emsp;There are also further financial and technical limitations with Neo4j itself, which has different tiers, pricing, memory limits, and other constraints we have yet to run into. Further research is needed; we detail this below.   </p>
        <br><br><b class="subheading">future work</b>
        <p class="writeup">&emsp;Our group has also determined some courses of action we would ideally take from here - there are several aspects of this solution that need to be fleshed out further:
          <br>&emsp;An important step moving forward would be to meet with the lab team to talk about the best way to output “workable” data moving forward, so that at the end of our data pipeline they can run any queries or analyses they might need easily. 
          <br>&emsp;Last but not least, we would need to look further into Neo4j for the future. Assuming this is a model that will be adopted and used for a while, we need to investigate pricing, size limits, and query effectiveness/efficiency as the database grows in size. We also would like to become more familiar with their Cypher query language to understand not only its limitations but also its potential for how complex queries can be.
          </p>         
      </section>

      <section id="refs" class = "bodytext">
        <div class="section_header"><div class="card_div"></div><h2>references</h2></div>
          <p class="writeup"><b>existing data pipeline</b><br><br></p>
      </section>

      <footer>
        <a href="#landing" class="scroll"><div>
            <br><br><span></span>
            [back to top]</div></a>
      </footer>
      <br>
    </div>
  <!-- scripts  -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.1/ScrollTrigger.min.js"></script>

  <script src = "script.js"></script>
  </body>
</html>